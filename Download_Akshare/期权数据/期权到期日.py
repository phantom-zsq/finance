import pandas as pd
import akshare as ak
from sqlalchemy import create_engine
import time
from datetime import date

if __name__ == '__main__':
    # set option of pandas
    pd.set_option('display.max_rows', None)  # 显示所有行
    pd.set_option('display.max_columns', None)  # 显示所有列
    pd.set_option('display.width', 1000)  # 调整宽度避免换行
    # create mysql engine
    engine = create_engine('mysql+pymysql://root:12345678@localhost:3306/akshare')

    # 定义二维表的列（字段）
    columns = ["到期日分组","合约日期","到期日"]

    # 生成10行数据（10条记录）
    history_data = [
        ["1", "2507", "20250609"],
        ["2", "2507", "20250611"],
        ["3", "2507", "20250612"],
        ["4", "2507", "20250618"],
        ["5", "2507", ""],
        ["6", "2506", "20250620"],
        ["7", "2507", "20250624"],
        ["8", "2508", "20250626"],
        ["1", "2508", "20250707"],
        ["2", "2508", "20250711"],
        ["3", "2508", "20250715"],
        ["4", "2508", "20250716"],
        ["5", "2508", ""],
        ["6", "2507", "20250718"],
        ["7", "2508", "20250725"],
        ["8", "2509", "20250729"],
        ["1", "2509", "20250807"],
        ["2", "2509", "20250813"],
        ["3", "2509", "20250813"],
        ["4", "2509", "20250818"],
        ["5", "2509", ""],
        ["6", "2508", "20250815"],
        ["7", "2509", "20250825"],
        ["8", "2510", "20250827"],
        ["1", "2510", "20250905"],
        ["2", "2510", "20250911"],
        ["3", "2510", "20250912"],
        ["4", "2510", "20250916"],
        ["5", "2510", ""],
        ["6", "2509", "20250919"],
        ["7", "2510", "20250924"],
        ["8", "2511", "20250926"],
        ["1", "2511", "20251015"],
        ["2", "2511", "20251013"],
        ["3", "2511", "20251015"],
        ["4", "2511", "20251024"],
        ["5", "2511", ""],
        ["6", "2510", "20251017"],
        ["7", "2511", "20251027"],
        ["8", "2512", "20251029"],
        ["1", "2512", "20251107"],
        ["2", "2512", "20251112"],
        ["3", "2512", "20251112"],
        ["4", "2512", "20251118"],
        ["5", "2512", ""],
        ["6", "2511", "20251121"],
        ["7", "2512", "20251124"],
        ["8", "2601", "20251126"],
        ["1", "2601", "20251205"],
        ["2", "2601", "20251211"],
        ["3", "2601", "20251215"],
        ["4", "2601", "20251216"],
        ["5", "2601", "20251218"],
        ["6", "2512", "20251219"],
        ["7", "2601", "20251225"],
        ["8", "2602", "20251229"]
    ]

    data = [
        ["1", "2602", "20260109"],
        ["2", "2602", "20260113"],
        ["3", "2602", "20260114"],
        ["4", "2602", "20260120"],
        ["5", "2602", "20260119"],
        ["6", "2601", "20260116"],
        ["7", "2602", "20260126"],
        ["8", "2603", "20260128"]
    ]

    # 创建纯粹的二维表DataFrame（仅包含行列结构，无额外业务字段）
    df = pd.DataFrame(data, columns=columns)
    res = df.to_sql('expiration_date', engine, index=False, if_exists='append', chunksize=10000)